# Basic vars
set shell bash
set shellopts '-eu'
set ifs "\n"
set scrolloff 10
set icons true #Read ~/.config/lf/icons
set sortby time #mtime
set reverse true #Show newest files first
set incsearch true
set incfilter true
set period 1 #Set the interval in seconds for periodic checks of directory updates
set autoquit on #Automatically quit server when there are no clients left connected
set mouse true #Send mouse events as input
set preview true
set previewer ~/.config/lf/lf_kitty_preview
set cleaner ~/.config/lf/lf_kitty_clean

# cmds/functions
cmd on-cd &{{
    #Show current directory in window title
    printf "\033]0; $(pwd | sd "$HOME" "~") - lf\007" > /dev/tty
}}
on-cd
cmd open $set -f; rifle -p 0 "$fx"
cmd open-with ${{
    set -f
    rifle -l "$fx"
    read -p "Open with: " method
    rifle -p "$method" "$fx"
}}
map r open-with
cmd mkdir $mkdir -p "$(echo $* | tr ' ' '\ ')"
cmd trash %trash "$fx"
cmd z %{{
    result="$(zoxide query --exclude $PWD $@)"
    lf -remote "send $id cd $result"
}}
cmd zi ${{
    result="$(zoxide query -i)"
    lf -remote "send $id cd $result"
}}

# Warn about nested instances
%[ $LF_LEVEL -eq 1 ] || echo "Warning: You're in a nested lf instance!"

# Bindings
map g top
map DD trash
map <delete> trash
map E extract
map y copy
map x cut
map p paste
map Y $printf "$f" | wl-copy #copy full path of the current file
map <esc> clear
map <c-n> push :mkdir<space>
map <c-r> reload
map <c-f> $lf -remote "send $id select \"$(fzf)\""
map <backspace> set hidden! #<backspace> is ctrl-h, <backspace2> is backspace
map <enter> shell
map o &xdg-open "$f"
map O open-with

map <f-2> rename
map A push <f-2> # at the very end
map I push A<c-a> # at the very beginning
map r push A<a-b><c-b> # before extension

map e push :!nvim<space>
